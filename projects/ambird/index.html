<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="author" content="Christoffer Nørbjerg">
    <meta name="description" content="Christofer Nørbjerg&#39;s personal website">
    <meta name="keywords" content="blog, developer, student, consulent, backend, frontend, personal">

    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Ambird"/>
<meta name="twitter:description" content="Ambient Bird This project was completed during the Advanced Physical Computing course. This course had three distinct aspects, combined to create an overall goal. First of all we were tasked to create our own embedded software, without using anything but micro controllers as our CPU, meaning no Arduino/Raspberry and the like. In our case we used an ATMega8. Secondly the product would have to be ambient, able to pass as an object in the background, while still managing to complete it&rsquo;s task Thirdly it had to give value to peoples lives, e."/>

    <meta property="og:title" content="Ambird" />
<meta property="og:description" content="Ambient Bird This project was completed during the Advanced Physical Computing course. This course had three distinct aspects, combined to create an overall goal. First of all we were tasked to create our own embedded software, without using anything but micro controllers as our CPU, meaning no Arduino/Raspberry and the like. In our case we used an ATMega8. Secondly the product would have to be ambient, able to pass as an object in the background, while still managing to complete it&rsquo;s task Thirdly it had to give value to peoples lives, e." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://www.norbjerg.dk/projects/ambird/" />
<meta property="article:published_time" content="2019-06-28T10:46:19&#43;02:00"/>
<meta property="article:modified_time" content="2019-06-28T10:46:19&#43;02:00"/>


    
      <base href="http://www.norbjerg.dk/projects/ambird/">
    
    <title>
  Ambird · Christoffer Nørbjerg
</title>

    
      <link rel="canonical" href="http://www.norbjerg.dk/projects/ambird/">
    

    <link href="https://fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather:300,700%7CSource+Code+Pro:400,700" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin="anonymous" />

    
      
      
      <link rel="stylesheet" href="/css/coder.min.28d751104f30c16da1aa1bb04015cbe662cacfe0d1b01af4f2240ad58580069c.css" integrity="sha256-KNdREE8wwW2hqhuwQBXL5mLKz&#43;DRsBr08iQK1YWABpw=" crossorigin="anonymous" media="screen" />
    

    

    

    
      <link rel="stylesheet" href="/css/styles.css" />
    

    
    
    <link rel="icon" type="image/png" href="http://www.norbjerg.dk/images/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="http://www.norbjerg.dk/images/favicon-16x16.png" sizes="16x16">

    <meta name="generator" content="Hugo 0.55.6" />
  </head>

  <body class=" ">
    <main class="wrapper">
      <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="http://www.norbjerg.dk/">
      Christoffer Nørbjerg
    </a>
    <input type="checkbox" id="menu-toggle" />
    <label class="menu-button float-right" for="menu-toggle"><i class="fas fa-bars"></i></label>
    <ul class="navigation-list">
      
        
          <li class="navigation-item">
            <a class="navigation-link" href="/posts/">Blog</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="/projects">Projects</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="/about/">About</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="/contact/">Contact</a>
          </li>
        
      
      
    </ul>
  </section>
</nav>


      <div class="content">
        
  <section class="container page">
  <article>
    <header>
      <h1>Ambird</h1>
    </header>

    

<h5 id="ambient-bird">Ambient Bird</h5>

<p><img src="/img/ambird.jpg#floatright" alt="Display of the finished Ambird" />
This project was completed during the Advanced Physical Computing course. This course had three distinct aspects, combined to create an overall goal. First of all we were tasked to create our own embedded software, without using anything but micro controllers as our CPU, meaning no Arduino/Raspberry and the like. In our case we used an ATMega8. Secondly the product would have to be ambient, able to pass as an object in the background, while still managing to complete it&rsquo;s task Thirdly it had to give value to peoples lives, e.g. saving the environment, bringing people closer together etc.</p>

<p>Out of these requirements came the Ambird, an attempt to create a different tool to communicate in long-distance relationships. Each Ambird is paired with exactly one other Ambird, which is then given to the partner. By hovering your hand over the bird, and moving up and down, you could scroll through up to 8 preprogrammed colors and by whistling send that color to your paired device. The partner&rsquo;s Ambird would then light with that color until cleared by hovering your hand above the lamp.</p>

<p>The idea was for the couple to develop their own language of colors to use, to communicate their mood or thoughts to each other without having to put in in words.</p>

<h3 id="technologies">Technologies</h3>

<p>The microcontroller was programmed using Basic.</p>

<p>The rest of the project was mainly consisting of piecing together small electronics such as sensors, LEDs and making circuit boards. Lastly, much effort also went into researching and proving that our solution gave value.</p>

<h3 id="code-example">Code example</h3>

<pre><code>$baud = 9600
$crystal = 8000000

'Ports setting up ports
'Using ADC on PortC4 and PortC5
'Rest of PortC is set as output manually to avoid
'overwriting the ADC configuration
Config Portb = Output
Config Portd = Output
Config Adc = Single , Prescaler = Auto
Config Portc.0 = Output
Config Portc.1 = Output

'Setting up Timer for PWM usage
'This allows us to send an 8bit value as analog output
'This is used for controlling the strength of the Red and Blue
'LEDs within the RBG-LED
'Theres only 2 of those ports on the ATmega8, hence why the green is not
'controlled in this way
Config Timer1 = Pwm , Pwm = 8 , Compare_a_pwm = Clear_up , Compare_b_pwm = Clear_up , Prescale = 1


'Declaring subs:
'Sets the color of the LED to predefined color. Parameter corresponds to a color
Declare Sub Setcolor(byval Color As Byte)
'Shuts off the RGB LEDs
Declare Sub Resetcolor()
'Blinks the LEDs on their current color a few times to signal
'that the color has been sent
Declare Sub Colorblink()
'Subs to set colors, to make the code look cleaner
Declare Sub Setgreen(byval Value As Byte)                   '2bit (0-3)
Declare Sub Setred(byval Value As Byte)                     '8bit (0-255)
Declare Sub Setblue(byval Value As Byte)                    '8bit (0-255)

'Takes a distance from the IR-sensor, and translates it to a number
'that corresponds to a color in the subroutine 'setcolor'
Declare Function Irtocolortranslater(byval Distance As Byte) As Byte
'Takes a value from the IR-sensor and translates it into a cm-value
'Will return 255 as an error value for debouncing purposes.
Declare Function Getirvalue() As Byte
'Checks the current input from the microphone, if higher than a predefined value
'it will return 1, otherwise 0
'Somehow we could not get this function to work with &quot;bit&quot; as value_type
Declare Function Ismicinputhigh() As Byte
'This function takes an ascii-input from the bluetooth
'and with a primitive method translates it to a color-number
Declare Function Translateinput(byval Asciival As Byte) As Byte

'Variables
'Holds a value for the current color displayed
Dim Localcolor As Byte
'Hold a value for the color received from the paired device
Dim Receivedcolor As Byte

'Flags to ensure the Do-loop runs as it should:
'This flag allows you to turn off a received signal with the IR
'Instead of starting to set a new color
Dim Hasreceivedcolor As Bit
'This prevents the Do-loop to reset the color that has been received
Dim Issettingcolor As Bit


'Used for debouncing in GetIrValue
'The Value read from the IR has to be the same multiple times in a row
'to avoid random reads from the IR to be returned.
Dim Debouncer1 As Byte
Dim Debouncer2 As Byte
Dim Debouncer3 As Byte

'The current value from the IR in cm
Dim Irvalue As Byte


'Setting up default values
Debouncer1 = 0
Debouncer2 = 0
Debouncer3 = 0


'The main loop of the program
Do
Irvalue = Getirvalue()
'If the IR-value (in centimeters) enter loop
While Irvalue &gt;= 5 And Irvalue &lt;= 25
    Issettingcolor = 1
    'If the current color has been received, turn it off
    If Hasreceivedcolor = 1 Then
        Call Resetcolor()
        Hasreceivedcolor = 0
        Waitms 4000
    'Otherwise it means that the user wants to specify a color for
    'him/her to send
    Else
        Localcolor = Irtocolortranslater(irvalue)
        Call Setcolor(localcolor)
        'Checks if the color currently selected should be sent
        If Ismicinputhigh() = 1 Then
            'transmit which color was selected to paired AmBird
            Print Localcolor
            'Colorblink is a visual feedback that shows the color has been sent
            Call Colorblink()
        End If
    End If
    Waitms 15
    'To avoid the whileloop to run forever, we need to check for new IrValues
    Irvalue = Getirvalue()
Wend
'This flag allows you to turn off a received signal with the IR
'Instead of starting to set a new color
If Issettingcolor = 1 And Irvalue &lt;&gt; 255 Then
    Call Resetcolor()
    Issettingcolor = 0
End If

'Checks if theres an input from the bluetooth component
'and that an illegal value hasnt been read from the IR
While Ischarwaiting() = 1 And Irvalue &lt;&gt; 255
    Receivedcolor = Waitkey()
    'convert from Ascii
    Receivedcolor = Translateinput(receivedcolor)
    If Receivedcolor &gt; 0 And Receivedcolor &lt; 7 Then
        'Sets a flag
        Hasreceivedcolor = 1
        Call Setcolor(receivedcolor)
    End If
Wend
Waitms 25
Loop

'Converts an Ascii number to a decimal number, very primitively
Function Translateinput(asciival As Byte)
Local P As Byte
P = Asciival - 48
Translateinput = P
End Function

'Returns 0 or 1 depending on the MicInput
Function Ismicinputhigh()
Local P As Word
P = Getadc(5)
If P &gt; 505 And P &lt; 1000 Then
    Ismicinputhigh = 1
Else
    Ismicinputhigh = 0
End If
End Function

'Gets a value from the IR-sensor and converts it to CM
'Then it saves the values in the Debouncers.
'If all the debouncer variables are equal to P
' (note That Debouncer1 Will Always Be Equal To P)
'Then The Value In Cm Is Returned, Otherwise Its Deemed As A Random Value
Function Getirvalue()
Local P As Integer
P = Getadc(4)
P = P - 11
P = 2076 / P
If P &gt; 0 And P &lt; 30 Then
    Debouncer3 = Debouncer2
    Debouncer2 = Debouncer1
    Debouncer1 = P
    If Debouncer2 = P And Debouncer3 = P Then
        Getirvalue = P
    Else
        Getirvalue = 255
    End If
Else
    Getirvalue = 0
End If
End Function

'Translates a distance in CM to a number representing a color
Function Irtocolortranslater(byval Distance As Byte)
Local P As Byte
P = Distance
P = P - 2
P = P / 3
Irtocolortranslater = P
End Function

'Sets the green LEDs value with an R/R2 ladder
'and a binary value from 0-15
Sub Setgreen(value As Byte)
If Value &lt; 4 Then
    Reset Portc.0
    Reset Portc.1
    If Value &gt;= 2 Then
        Set Portc.1
        Value = Value - 2
    End If
    If Value = 1 Then
        Set Portc.0
        Value = Value - 1
    End If
End If
End Sub

'Set red LED with PWM
Sub Setred(value As Byte)
Pwm1a = Value
End Sub

'Set red LED with PWM
Sub Setblue(value As Byte)
Pwm1b = Value
End Sub

'Simple sub that blinks the current color and the shuts off the LED
Sub Colorblink()
Local A As Byte
For A = 1 To 3 Step 1
    Call Resetcolor()
    Waitms 600
    Call Setcolor(localcolor)
    Waitms 400
Next
Call Resetcolor()
Waitms 2000
End Sub

'Turns off the entire RGB-LED
Sub Resetcolor()
Pwm1a = 0
Pwm1b = 0
Reset Portc.0
Reset Portc.1
End Sub

'Sets a color depending on the value (controls both red, blue and green)
Sub Setcolor(color As Byte)
If Color &gt;= 1 And Color &lt;= 6 Then
    Call Resetcolor()
    Select Case Color
        Case 1 : Call Setred(255)                          'Red
        Case 2 : Call Setred(255)                          'purple
                Call Setblue(255)
        Case 3 : Call Setred(150)                          'yellow
                Call Setgreen(3)
        Case 4 : Call Setgreen(3)                          'green
        Case 5 : Call Setgreen(3)                          'teal
                Call Setblue(60)
        Case 6 : Call Setblue(255)                         'blue
    End Select
End If
End Sub
End
</code></pre>

  </article>
</section>


      </div>

      <footer class="footer">
  <section class="container">
    
     © 2019
    
       · 
      Powered by <a href="https://gohugo.io/">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/">Coder</a>.
    
    
  </section>
</footer>

    </main>

    

  </body>

</html>
